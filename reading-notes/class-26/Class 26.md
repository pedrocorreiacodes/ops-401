## Class 26

### Reading: Cyber Threat Analyst: Key Job Skills and Expected Salary

------

A cyber threat analyst is an iformation security professional who levarages skills and expertise of network engineering to mitigate and avoid cyberattacks on the organization or is employees. They identify vulnerabilities and conduct digital forensic and threat modeling to monitor and tackle threats agains organizational infrastructure.

#### Typical Duties of a Cyber Threat Analyst

+ Continually monitor the network of an enterprise for nay security breach and investigate in case any violations occurs
+ Install and use software like data encryption programs and firewalls to proetect sensitive information
+ Perform penetration testing by simulating attacks to identify any vulnerabilities
+ Develop reports documenting secuirty breaches that have ocurred and the extent of damage caused by those breaches
+ Craft  scurity standards and bes practices for a company
+ Keep up to data with the latest IT security trends
+ Work with the security team to develop digital security polices and implement them
+ Provide recommendation on security enhancements to senior management
+ Make decision and evaluate the best tools for any given secuity issue
+ Monitoring and audit of system and processes like identity and access managemetn which may involve methodologies like zero trust security
+ Help in delivering cybersecurity awareness training

#### Expected Salary Scales

On average, cybersecurity jobs opening take 20% longer to fill than typicall information technology roles.

+ The average entry-level cyber threat analyst salary in the United States typically revolves around $84,000 per year
+ With more years of experience, you can expect to earn between $98,885 to $126, 976

Top 10 Must-Have Skill ofr a Successful Carrer as Cyber Threat Analyst

1. Formal Education in a Related Filed

   Even if you already have an undergraduate degree in another field, you still can become a threat analyst by getting the required certifications/ degrees

2. Ability to Dig Deeper and Focus on the Details

   + Analytical bent of mind and stong diagnostic skills
   + High adaptability to new work environments and fast-changin business landscapes
   + Keeness to deep dive into the technical aspects and examine them thoroughly
   + Keeping one step ahead of common web vulnerabilities
   + knowlege and awareness of comtemporary practices, standards, methods, and procedures

3. Technical Know-How

   It's a bit tricky to identify which technical skills a cyber threat pro must possess exactly. Most job profiles share a common technical foundation.

   + Basic understanding of the administration, management, and architecture of operation systems such as Linux, UNIX, Windows, etc. along with networking and virtualization software
   + A command over firewalls and network load balancers is also crucial, apart from the general concepts of software development, programming, and analytics skills.
   + Basic understanding of the common programming language like C, C++, Java, assembly language, disassemblers, and scripting languages (Perl, Python, Shell, or PHP)
   + Certifications (however, they should never alone be the only reference)
     + OSCP (Offensive Security Certified Professional)
     + CEH (Certified Ethical Hacker)
     + GCIH (GIAC Certified Incident Handler)
     + CISA (Certified Information Security Auditor)
     + CISSP-ISSEP (Information Systems Security Engineering Professional)
     + CISSP-ISSAP (Information Systems Security Architecture Professional)
     + CISSP (Certified Information Systems Security Professional)
     + CISSP-ISSMP ((Information Systems Security Management Professional)

4. Familiarity with Various Tools, Methodologies and Platforms

   Professionals should have the ability to collect data from Indicators of Compromise (IoC) - critical forensic evidence of intrusions on networks. The data collection can be done both from internal as well as external resources.

   They must also be competent with using visual link analysis tools that enable analysts to see multilevel links among various tools that enable analysts to see multilevel links among various threat entities, actos and IT infrastructure. Some of the major link analysis tools that pros leverage for data visualization include Sentinel Visualizer, i2 Analyst's Notebook, Maltego, and more.

5. Good Communication Skills

   A successful cyber threat intelligece analyst must be able to present their findings and ides in well-written and clearly articulated reports. Mus also possess great oral communication skills as it will have to communicate with management, colleagues, and alos possibly give presentation to current and prospective customers as it progresses in the carrer 

6. Strong Implementation Skills

   Holistic view o the company's security set up which includes specification, threat modeling, testing, implementation, and vulnerability assessment.

7. Subject Matter Expertise and Foreign Language Skills

8. Ability to conduct detailed assessments and provide strategic recommendations

   Senior cyber threat pros must organize and coordinate technical vulnerability assessments, which include

   + Systems and networl vulnerability assessments
   + Web application assessments
   + Physical security asssessments
   + Social engineering assessments
   + Wireless security assessments
   + Penetration testing
   + Implmeneting secure infrastructure solutions

9. Data expertise

   Shoud be familiar with different methods to acquire and stuy data to drive insights that help perform their work.

   Data collection souces include:

   + Search engines (Threat Crowd, Google Hacking Database)
   + Website foot printings
   + Web services
   + DNS interrogation
   + Cyber counterintelligence (CCI) techniques
   + Automated OSINT tools

10. Must Understand the Hacker Mindset

    To reduce the risk of external hacking attacks it's necessary to understand the hacker mindset



### Reading: Tracking, Detecting, and Thwarting PowerShell-based Malware and Attacks

------

Traditional malware and attacks rely on crafted executables to function.

Fileless malware reside in memory to evade taditional scanners and detection methods.

PowerShell provides an ideal cover for threat actors as they craft payload heavily dependents on its deep Windows integration.

#### What is PowerShell?

------

Scripting language and command-line shell base on .NET classes that helps sytems administrators automate taks in managing operating systems.

Poweshell enables faster and improved access to the underlying operating systems (such as the registry and certificate store), allowing users and administrators to manage more functions of a system locally as well as remotely.

PowerShell interaction occurs through cmdlets, which are commands that enable actons on .NET objects.

#### What makes PowerShell and effective attack vector?

------

Virus-infected files and malicious trojans are established malware types, and developers have various defensive detection and mitigation techniques to defend against them. Browsers verify downloaded files; application aneed approved permissions before installation; and security software acan scan files to be written, read, and/or executed to check for known signatures.

Attackers can use fileless malware to get around these safeguards by injecting payloads into running application or by utilizing scripting. PowerShell is an ideal channel for delivering these attacls because of its wide deployment and access to all parts of a host via the. NET framework.

Additionally, it is easy to develop scripts applicable for payload delivery, and because PowerShell is a trusted application, it will amost always be allowed to execute scripts with impunity.

#### Prominent attacks and enfection using PowerShell

------

Resources for abusing PowerShell are easily available online, malicious actors of varying degrees of sophistication have emerged. Threat actos have deployed campaigns using social engineering techniques to infect systems, combining PowerShell with other exploits or seemingly replicating other routines as a part of of cybercriminal research and development.

One of the most infamous compromises using the PowerShell for intrusion was linked to the release of internal emails from the Democratic National Committee by adversary grou Paw Storm in 2016. Forensic investigation of the network showed initial compromise as far back as 2015 eith a backdoor delivered by a single PowerShell command, while other deployments that matched the ourtine began as early as 2014.

#### Mitigation and best practices

------

PowerShell is known to enable significant activity loggin capabilities. These functions can also be used to detect, defendm and mitigate against the abuse ot this tool. System administrators can enable these logging features through Active Directory Group Policy for enterprise-wide implementation

### Lecture

------

#### Carrers in Threat Analysis

+ Cyber threat analysts leverage skills and expertise of network engineering to mitigate and avoid cyberattacks on the organization or its employees
  + Identify vulnerabilities
  + Study digital forensics
  + Conduct threat modeling
  + Simulate attacks, recommend defenses
  + Monitor networks

#### Threat Analysis

+ Cyber threat analysis is a process used by cybersecurity threat analysts to study and align a particular organization's defenses against its potential or realized cyber threats
+ Threat analysis aims to answer:
  + What are we working on?
  + What are the things that can go wrong?
  + How do we go about problems that occur?
  + Did we do a good job?

#### Threat Modeling

+ Cyber threat modeling is the structured process used to determine potential security threatsand weaknesses, assess risk levels per threat and implement mitigations against specific threats.
  + Optimally conducted during development of the app or system
  + Can be conducted any time

#### Threat Modeling Methodologies

+ STRIDE
+ DREAD
+ PASTA
+ Trike
+ VAST
+ Attack Tree
+ Common Vulnerability Scoring System (CVSS)
+ T-MAP
+ OCTAVE
+ Quantitative Threat Modeling Method

#### Case Study: Colonial Pipeline

+ Attack techniques used by DarkSide
  + Human-operated ransomware attack
  + First, breach the target network
  + Move laterally unitl an administrator account is compromised, then take ove the Windows DC
  + Uncencrypted data harvested and exfiltrated
  + Stolen data posted to attacker's website
    + Company name
    + Data company breached
    + How much data stolen
    + Screenshots of data
    + Type of stolen data
  + Create a customized ransomware executable
  + Custom ransomware executes and obfuscated (encoded) PowerShell command that deletes Shadow Volume Copies on the victim to prevent data file restoration
  + @malwarehunterteam found that DarkSide purposely avoids infecting victims in CIS countries
  + Similar to what is used in REvil and also GandCrab

#### Stages of Exploitation

+ Pre-Exploitation
  + OS identification
  + Software Identification
  + Version identification
+ Exploitation
  + Memory preparation
  + Vulnerability preparation
  + Memeory disclosure
  + Payload preparation
  + Code Execution
+ Post-Exploitation
  + Return Oriented Programming
  + Payload Execution
  + Continuation of Execution
  + Persistence

### Remote Code Execution

------

Adversaries may abuse PowerShell commands and scripts for execution **T1069.001**.

+ Executing commands
+ Leveraging encoded commands
+ Ofuscation (with and without encoding)
+ Download additional payloads
+ Launching additional processes
+ Examples
  + Start-Process cmdlet
    + Executes processes
  + Invoke-Command cmdlet
    + Runs a command locally or on a remote computer
+ Required: Administrator permissions to connect
+ **MS15-011**: Vulnerability in Group Policy could allow remote code execution (February 10, 2015)
+ "PowerShell represents one of the most interesting and powerful languages for a pentesting purpose."
+ "...for us, as pentesters, PowerShell represent a powerful shell and scripting language which is presents on our pentest targets and provide to us specially a powerful post-exploitation "tools/language" that can give us so much power and very big attack surface/possibility." - Infosec Institute
+ Remote code execution (RCE) is a class of security vulnerabilities that allows a malicious actor to execute any code of their choice on a remote machine over LAN, WAN, or internet
+ Post-exploitation includes the phases of operation once a victim's system has been compromised by the attacker. 
  + Examples of post-exploitation frameworks
    + Powershell Empire
    + Metasploit
+ Porshell Empire is a pure PowerShell post-exploration agent built on cryptologically-secure communications and a flexible architecture.
+ Emprie implements the ability to run PowerShell agents without needing powershell.exe
+ Includes rapidly deployable post-exploitation modules rangin from key loggers to Mimikatz
+ Supports adaptable communications to evade network detection
+ **Invoke-Ps-Exec** is a cmdlet that lets you execute PowerShell and batch/cmd.exe code asynchronously on target Windows computers, using PsExec.exe
+ PsExec can be downloaded from the SysInternals suite on Microsoft's site
+ How can we defend against RCE threats?