## Class 18

### Reading: Introduction to AWS CloudWatch

------

Amazon CloudWatch is a service used for real-time monitoring AWS resources an also can use for monitoring on-prem resources. A service to collect & track matrices, monitor files, set alarms. It automatically provides metrics for CPU utilisation, latency and request count. Custom CloudWatch metrics can be monitored such as memory usage, error rates and more in a detailed manner. It's useful service for cronjob and automation purposes.

By default, EC2 sends metrics to Amazon CloudWatch and each data point covers the 5 minutes that follow the start time of the activity for the instance. Using CloudWatch detailed monitoring, each data point covers the next minute from the start time.

#### What is CloudWatch Event?

CloudWatch Events allows users to consume a near real-time stream of events like changes to their AWS environment. They can trigger notification services like SNS, SMS etc. or an trigger other AWS services like Lambda, SSM, Step function. CloudWatch Events can monitor actions like an AWS service being lauched/ terminated and detect when an auto-scale happens.

Using CloudWatch event you can create a custom role to trigger target AWS resources for automation purposes based on event, role or time schedule.

+ **Events** are represented by a JSON script. Generated in four ways:
  + From within AWS when the resource changes
  + Generated by API calls
  + Console sign-ins that are delivered to Amazon CloudWatch Events via CloudTrail
  + When your own code can generate application-level events and publish them to Amazon CloudWatch Events for processing.
+ **Rules** match incoming events and route them to one or more targets or processing. Rules do not have any order for processing, all the rule matching for an event will be processed.
+ **Targets** process events and are specified within the rules

#### What is CloudWatch Agent?

AWS provides CloudWatch agent that can be configured on the EC2 instances to send Custom Metrics to CloudWatch.

That agent supports multiple operating systems like Amazon Linux, CentOS, Red hat, Windows Server (2008 onwards), Debian, Ubuntu OS. With the help of IAM role access, the agent collects live metrics from the server and sends data to CloudWatch for monitoring.

The agent can be installed on an on-premises server.

#### What is CloudWatch Alarm?

You can create an alarm based on target's CloudWatch metrics or the rulst of a math expression based on CloudWatch metrics. The alarm performs one or multiple action based on a metric value or specified conditions. These actions can be based on a AWS resource ( (E.g.: An Amazon EC2 action, an EC2 Auto Scaling action, a Lambda function, or a notification sent to an SNS topic).)

CloudWatch dashboards are designed with a goal of providing better visibility when monitoring AWS resources across regions in a consolidated view. When an alarm is on a dashboard, it turns red when when it is in the ALARM state.

#### What is Amazon CloudWatch Logs?

CloudWatch Logs help users to access, monitor & store access log files from AWS resources like EC2, Lambda functions, CloudTrail, Route 53 and othe resources. CloudWatch Logs enables you to centralizes the logs from all your systemsm applications, and AWS services. It offers near real-time monitoring and users can search, filterfor specific phrases, values or patterns. Metric filters define patterns and terms to look for in log data as it is sent to CloudWatch Logs. Yo can use subscriptions to get access to a real-time feed of log events from CloudWatch Logs and have it delievered to other services such as Amazon Kinesis stream, Amazon Kinesis Data Firehose stream or AWS Lambda for custom processing analysis or loading to other systems.

CloudWatch logs are a managed service that can be provisioned without extra purchases from within your AWS accounts.

While some use the built-in ability to push Amazon CloudWatch logs directly into Amazon Elasticsearch Service for analysis, others would prefer to move all logs into a centralized Amazon S3 bucket location for access by several custom third-party tools.

After enabling Anomaly detection for a metric, CloudWatch applies statistical and machine learning algorithms that continuously analyze metrics of systems or application and determine normal baselines, and surface inconssistency with minimal user involvement.

**CloudWatch Anomaly Detection capabilities:**

+ Learn and model the expected behaviour of a metric based on prior data.
+ Calculate expected values and generates the Anomaly Detection band. This is based on a lower and an upper band metric generated by the model. Metric values that fall outside the predicted confidence band are considered anomalies.
+ Enable your to create alarms based on the Anomaly Detection band and remediate detected anomalies.
+ AWS API  & CloudFormation support.

### Lecture

------

#### Why do we care about cloud?

+ If there is a 50% increase in a market there will be a parallel increase in the amount of staffing and hiring in that market.
+ Job postings looking for Azure and AWS talent have skyrocketed in the past year and are continuing to trend upwards.
+ Between 2020 and 2021 CSPs have increased revenue 50% with Microsoft eating Amazons lunch and spinning up more new clients.

#### Cloud Logging and Monitoring

+ How can we achieve governance, compliance, and auditing of our cloud?
+ How can we collect event logs in the cloud?
+ What tooling helps us analyze event log data?
+ How can the cloud react to security concerns as they occur?
+ How can we monitor and protect our VPCs?

#### AWS CloudTrail

+ AWS CloudTrail is a service that enables governance, compliance, operational auditing, and risk auditing of your AWS account.
+ Each CloudTrail log includes the following parameters:
  + The service
  + The name of API action performed
  + Region resource located in
  + Response elements
  + Principal that made the request
  + Date and time of the request (timestamp)
  + IP address of the requester
+ CloudTrail logs performs the following:
  + Maintains event history of account activity, including CLI
    + Pricing
      + "You can view, filter, and download the most recent 90 days of your account activity for all management events in suported AWS services free of charge."
  + What types of events are handled by AWS CloudTrail?
    + CloudTrail event classification:
      + API VS Non-API
      + Management vs Data Events

#### Amazon CloudWatch

+ Amazon CloudWatch is a monitoring and observability service built for DevOps engineers, developers, site reliability engineers (SREs), and IT managers.
+ Key functions include:
  + Infrastructure monitoring and troubleshooting
  + Resource optimization
  + Application monitoring
  + Log analytics
+ Amazon CloudWatch is a monitoring and observability service built ofr DevOps engineers, developers, site reliability engineers (SREs), and IT managers.
+ Key functions include:
  + Infrastructure monitoring and trouble shooting
  + Resource optimization
  + Apllication monitoring
  + Log analytics
+ Amazon CloudWach enables you to set alarms and automate actions based on either predegined thresholds, or on machine learning algorithms that identify anomalous behaiour in your metrics.
+ Key components include:
  + Alarms
  + Dashboards
  + Logs
+ CloudWatch Logs is a log aggregation service that supports ingestion of both AWS and non-AWS sources
  + Route 53 DNS query logs
  + VPC flow logs
  + CloudTrail logs
+ Logs from the same source are organized into a single log stream
+ Retention can be as short as 1 day or as long as 10 years
+ Archivable to S3 bucket
  + Metric filters
  + Events

#### VPC Flow Logs

+ VPC Flow Logs is a feature that enables you to captureinformation about the IP traffic going to and from network interfaces in your VPC.
+ Flow log data can be published to Amazon CloudWatch Logs or Amazon S3.
+ After you've created a flow log, you ca retrieve and view its data in the chosen destination.